# Migration 20260222170000: Add Missing Default Categories

## Purpose
This migration ensures that all transaction categories defined in `src/lib/categories.ts` are present in the database as default categories. It addresses an issue where the application code referenced more categories than were actually seeded in the initial setup.

## Problem Background
1. **Initial Setup (20260119000001)**: Only 8 expense and 4 income categories were seeded
2. **Code Evolution**: The application now defines 16 expense, 9 income, and 1 internal category
3. **Incomplete Updates (20260221120000, 20260221130000)**: These migrations updated existing categories and added some new ones, but several categories were still missing

## What This Migration Does

### Categories Added
This migration adds the following missing default categories:

**Expense Categories:**
- Langganan Digital (Digital Subscriptions)
- Bisnis & Produktivitas (Business & Productivity)
- Keluarga & Anak (Family & Children)
- Sosial & Donasi (Social & Donations)
- Investasi & Aset (Investment & Assets)
- Cicilan & Pinjaman (Installments & Loans)
- Penyesuaian Saldo (Balance Adjustment)

**Income Categories:**
- Penyesuaian Saldo (Balance Adjustment)

**Internal Categories:**
- Transfer (ensures it exists)

### Categories Renamed/Updated
The migration also ensures proper naming for:
- "Rumah" → "Rumah & Properti"
- "Lain-lain" (expense) → "Biaya Lain-lain"
- "Lain-lain" (income) → "Pendapatan Lain"

## Idempotency
The migration uses `IF NOT EXISTS` checks for all operations, making it safe to run multiple times. It will only insert categories that don't already exist.

## Impact
After this migration:
- All users will see the complete set of default transaction categories
- The application code and database will be in sync
- Users will have access to more granular category options for their transactions

## Testing
To verify the migration worked correctly:
```sql
-- Count default categories by type
SELECT type, COUNT(*) 
FROM public.categories 
WHERE is_default = TRUE 
GROUP BY type;

-- Expected results:
-- expense: 16
-- income: 9
-- internal: 1
```

## Related Files
- Source code: `src/lib/categories.ts`
- Initial setup: `supabase/migrations/20260119000001_categories_setup.sql`
- Income refinements: `supabase/migrations/20260221120000_refine_income_categories.sql`
- Expense refinements: `supabase/migrations/20260221130000_refine_expense_categories.sql`
